{% extends 'base_layout.html' %}
{% load static %}
{% load humanize %}

{% block title %}
Request | WebRecruiter
{% endblock %}

{% block stylesheet %}
<style media="screen">
i.icon-delete { color: #EB5E28; }
</style>
{% endblock %}
{% block content %}
<div class="container-fluid">
  <div class="row">
    <form >
      <div class="row">
        <div class="title-page">
          <div class="col-lg-10 col-sm-offset-1 text-center">
            <h2>TOR</h2>
            <div class="col-lg-10 col-sm-offset-1 text-center">
              <h4><small>คำร้องขอจำนวนและคุณสมบัติของผู้สมัคร<br/>เพื่อจัดหาทรัพยากรบุคคลตามความต้องการ ในกรณีที่ผู้สมัครในระบบไม่ตรงตามความต้องการ</small></h4>
            </div>
          </div>
        </div>
      </div>
      <br>
      <div class="col-md-12">
        <div class="card card-plain">
          <div class="card-header">

          </div>
          <div class="card-content">

            <div class="panel-group" id="accordion">
              <div class="panel panel-border panel-default">
                <a data-toggle="collapse" href="#collapseTwoPlain">
                  <div class="panel-heading">
                    <h4 class="panel-title">
                      NETWORK ENGINEER
                      <i class="ti-angle-down"></i>
                    </h4>
                  </div>
                </a>
                <div id="collapseTwoPlain" class="panel-collapse collapse">
                  <div class="panel-body">
                    <div class="content table-responsive table-full-width">
                              <table class="table table-hover" style="background-color:#fff; border-radius:5px;">
                                  <thead>
                                    <th data-field="position" data-sortable="true" class="text-left">ตำแหน่ง</th>
                                    <th data-field="tor_amount" data-sortable="true">จำนวนตาม TOR</th>
                                    <th data-field="now_amount" data-sortable="true">จำนวนตามจริง</th>
                                    <th data-field="diff_empty_amount" data-sortable="true">จำนวนที่ขาด</th>
                                    <th data-field="update" data-sortable="true">EDIT</th>
                                    <th data-field='actions' class='td-actions text-right' data-formatter='operateFormatter' data-events='operateEvents'>Actions</th>
                                  </thead>
                                  <tbody>
                                    {% for tor in Tors %}
                                    <tr>
                                      <td>{{ tor.position }}</td>
                                      <td>{{ tor.tor_amount }}</td>
                                      <td>{{ tor.now_amount }}</td>
                                      <td>{{ tor.diff_empty_amount }}</td>
                                      <td><a class="open-modal" rel="tooltip" title="Edit" href="" title="Edit" data-url="{% url 'update_tor' tor_id=tor.id %}"><i class="fa fa-edit"></i></a></td>
                                      <td></td>
                                    </tr>
                                    {% endfor %}
                                  </tbody>
                              </table>

                          </div>
                  </div>
                </div>
              </div>
              {% for tor in Tors %}
              <div class="panel panel-border panel-default">
                <a data-toggle="collapse" href="#collapseThreePlain{{ tor.id }}">
                  <div class="panel-heading">
                    <h4 class="panel-title">
                      {{ tor.position }}
                      <i class="ti-angle-down"></i>
                    </h4>
                  </div>
                </a>
                <div id="collapseThreePlain{{ tor.id }}" class="panel-collapse collapse">
                  <div class="panel-body">
                    <p>จำนวนตาม TOR : {{ tor.tor_amount }}</p>
                    <p>จำนวนตามจริง : {{ tor.now_amount }}</p>
                    <p>จำนวนที่ขาด : {{ tor.diff_empty_amount }}</p>

                  </div>
                </div>
              </div>
              {% endfor %}
            </div>

          </div>
        </div>
      </div>

    </form>
  </div>

</div>
{% endblock %}

{% block beforebody %}
<div class="modal-div"></div>
{% endblock %}

{% block javascript %}
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-46172202-4', 'auto');
ga('send', 'pageview');

</script>
<script>
var modalDiv = $("#modal-div");

$("a.open-modal").on("click", function() {
  alert($(this).attr("data-url"))
  $.ajax({
    url: $(this).attr("data-url"),
    success: function(data) {
      modalDiv.html(data);
      $("#myEdit").modal();
    }
  });
});

// function ShowModal() {
//   var modalDiv = $("#modal-div");
//     alert($(this).attr("data-url"))
//   $.ajax({
//     url: $(".open-modal").attr("data-url"),
//     success: function(data) {
//       modalDiv.html(data);
//       $("#myEdit").modal();
//     }
//   })
// }
</script>

{% endblock %}
